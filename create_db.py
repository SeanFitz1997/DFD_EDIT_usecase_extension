#=== Run this script to create DB for development and fill with demo data ===#
from App import db, bcrypt
from App.models import User, DataFlowDiagram, Graph, GraphChildren, Invitation, Edit


# Create tabels
db.create_all()

# Create demo user data
hashed_password = bcrypt.generate_password_hash('test').decode('utf-8')
user_1 = User(username='test_user1',
              email='test_user1@test.com', password=hashed_password)
user_2 = User(username='test_user2',
              email='test_user2@test.com', password=hashed_password)
user_3 = User(username='test_user3',
              email='test_user3@test.com', password=hashed_password)

db.session.add(user_1)
db.session.add(user_2)
db.session.add(user_3)
db.session.commit()

# Create graphs
context_diagram_xml_model = '<mxGraphModel><root><mxCell id="0"/><mxCell id="1" parent="0"/><process label="Food Ordering System" id="2"><mxCell style="fillColor=white;strokeColor=#343a40;fontColor=#343a40;rounded=1;foldable=0;" vertex="1" item_type="process" parent="1"><mxGeometry x="460.16668701171875" y="198" width="120" height="120" as="geometry"/></mxCell></process><mxCell id="3" value="0" style="fillColor=#343a40;fontColor=white;strokeColor=#343a40;rounded=1;editable=0;movable=0;resizable=0;cloneable=0;deletable=0;" vertex="1" connectable="0" parent="2"><mxGeometry width="120" height="24" as="geometry"/></mxCell><entity label="Customer" required_inflows="[]" required_outflows="[]" id="4"><mxCell style="fillColor=white;strokeColor=#343a40;fontColor=#343a40;rounded=1;foldable=0;" vertex="1" item_type="entity" parent="1"><mxGeometry x="144.66668701171875" y="83.33334350585938" width="100" height="80" as="geometry"/></mxCell></entity><entity label="Kitchen" required_inflows="[]" required_outflows="[]" id="5"><mxCell style="fillColor=white;strokeColor=#343a40;fontColor=#343a40;rounded=1;foldable=0;" vertex="1" item_type="entity" parent="1"><mxGeometry x="789.8333740234375" y="83.16668701171875" width="100" height="80" as="geometry"/></mxCell></entity><entity label="Restaurant Manager" required_inflows="[]" required_outflows="[]" id="6"><mxCell style="fillColor=white;strokeColor=#343a40;fontColor=#343a40;rounded=1;foldable=0;" vertex="1" item_type="entity" parent="1"><mxGeometry x="465" y="570" width="110" height="80" as="geometry"/></mxCell></entity><mxCell id="7" value="Customer Order" style="edgeStyle=topToBottomEdgeStyle;" edge="1" item_type="flow" source="4" target="2" parent="1"><mxGeometry x="-0.0118" y="10" relative="1" as="geometry"><Array as="points"><mxPoint x="220" y="220"/></Array><mxPoint as="offset"/></mxGeometry></mxCell><mxCell id="8" value="Receipt" style="edgeStyle=topToBottomEdgeStyle;" edge="1" item_type="flow" source="2" target="4" parent="1"><mxGeometry x="0.0229" y="-12" relative="1" as="geometry"><Array as="points"><mxPoint x="195" y="270"/></Array><mxPoint as="offset"/></mxGeometry></mxCell><mxCell id="9" value="Food Order" style="edgeStyle=topToBottomEdgeStyle;" edge="1" item_type="flow" source="2" target="5" parent="1"><mxGeometry x="-0.0024" y="11" relative="1" as="geometry"><Array as="points"><mxPoint x="710" y="250"/></Array><mxPoint as="offset"/></mxGeometry></mxCell><mxCell id="10" value="Management Reports" style="edgeStyle=topToBottomEdgeStyle;" edge="1" item_type="flow" source="2" target="6" parent="1"><mxGeometry relative="1" as="geometry"/></mxCell></root></mxGraphModel>'
food_ordering_system_xml_model = '<mxGraphModel><root><mxCell id="0"/><mxCell id="1" parent="0"/><entity label="Customer" required_inflows="[&quot;Receipt&quot;]" required_outflows="[&quot;Customer Order&quot;]" from_parent="true" id="2"><mxCell style="fillColor=white;strokeColor=#343a40;fontColor=#343a40;rounded=1;foldable=0;" vertex="1" item_type="entity" parent="1"><mxGeometry x="144.66668701171875" y="34.833343505859375" width="100" height="80" as="geometry"/></mxCell></entity><entity label="Kitchen" required_inflows="[&quot;Food Order&quot;]" required_outflows="[]" from_parent="true" id="3"><mxCell style="fillColor=white;strokeColor=#343a40;fontColor=#343a40;rounded=1;foldable=0;" vertex="1" item_type="entity" parent="1"><mxGeometry x="799.8333740234375" y="34.66668701171875" width="100" height="80" as="geometry"/></mxCell></entity><process label="Receive and Transform Customer Order" id="4"><mxCell style="fillColor=white;strokeColor=#343a40;fontColor=#343a40;rounded=1;foldable=0;" vertex="1" item_type="process" parent="1"><mxGeometry x="420" y="63" width="210" height="120" as="geometry"/></mxCell></process><mxCell id="5" value="1" style="fillColor=#343a40;fontColor=white;strokeColor=#343a40;rounded=1;editable=0;movable=0;resizable=0;cloneable=0;deletable=0;" vertex="1" connectable="0" parent="4"><mxGeometry width="210" height="24" as="geometry"/></mxCell><process label="Update Goods Sold File" id="6"><mxCell style="fillColor=white;strokeColor=#343a40;fontColor=#343a40;rounded=1;foldable=0;" vertex="1" item_type="process" parent="1"><mxGeometry x="212.66668701171875" y="282.66668701171875" width="120" height="120" as="geometry"/></mxCell></process><mxCell id="7" value="2" style="fillColor=#343a40;fontColor=white;strokeColor=#343a40;rounded=1;editable=0;movable=0;resizable=0;cloneable=0;deletable=0;" vertex="1" connectable="0" parent="6"><mxGeometry width="120" height="24" as="geometry"/></mxCell><process label="Update Inventory File" id="8"><mxCell style="fillColor=white;strokeColor=#343a40;fontColor=#343a40;rounded=1;foldable=0;" vertex="1" item_type="process" parent="1"><mxGeometry x="664" y="282.66668701171875" width="120" height="120" as="geometry"/></mxCell></process><mxCell id="9" value="3" style="fillColor=#343a40;fontColor=white;strokeColor=#343a40;rounded=1;editable=0;movable=0;resizable=0;cloneable=0;deletable=0;" vertex="1" connectable="0" parent="8"><mxGeometry width="120" height="24" as="geometry"/></mxCell><process label="Produce Management Reports" id="10"><mxCell style="fillColor=white;strokeColor=#343a40;fontColor=#343a40;rounded=1;foldable=0;" vertex="1" item_type="process" parent="1"><mxGeometry x="445" y="514" width="160" height="120" as="geometry"/></mxCell></process><mxCell id="11" value="4" style="fillColor=#343a40;fontColor=white;strokeColor=#343a40;rounded=1;editable=0;movable=0;resizable=0;cloneable=0;deletable=0;" vertex="1" connectable="0" parent="10"><mxGeometry width="160" height="24" as="geometry"/></mxCell><mxCell id="12" value="Customer Order" style="edgeStyle=topToBottomEdgeStyle;" edge="1" item_type="flow" source="2" target="4" parent="1"><mxGeometry y="13" relative="1" as="geometry"><mxPoint as="offset"/></mxGeometry></mxCell><mxCell id="13" value="Receipt" style="edgeStyle=topToBottomEdgeStyle;" edge="1" item_type="flow" source="4" target="2" parent="1"><mxGeometry x="0.9171" y="-115" relative="1" as="geometry"><Array as="points"><mxPoint x="195" y="140"/></Array><mxPoint as="offset"/></mxGeometry></mxCell><mxCell id="14" value="Goods Sold Data" style="edgeStyle=topToBottomEdgeStyle;" edge="1" item_type="flow" source="4" target="6" parent="1"><mxGeometry x="-0.2713" y="17" relative="1" as="geometry"><Array as="points"><mxPoint x="360" y="183"/></Array><mxPoint as="offset"/></mxGeometry></mxCell><mxCell id="15" value="Food Order" style="edgeStyle=topToBottomEdgeStyle;" edge="1" item_type="flow" source="4" target="3" parent="1"><mxGeometry y="14" relative="1" as="geometry"><Array as="points"><mxPoint x="730" y="130"/></Array><mxPoint as="offset"/></mxGeometry></mxCell><mxCell id="16" value="Inventory Data" style="edgeStyle=topToBottomEdgeStyle;" edge="1" item_type="flow" source="4" target="8" parent="1"><mxGeometry x="0.1066" y="-40" relative="1" as="geometry"><Array as="points"><mxPoint x="630" y="183"/></Array><mxPoint as="offset"/></mxGeometry></mxCell><datastore label="Inventory File" id="17"><mxCell style="fillColor=white;strokeColor=#343a40;fontColor=#343a40;rounded=1;foldable=0;" vertex="1" item_type="datastore" parent="1"><mxGeometry x="800" y="453.8333740234375" width="140" height="60" as="geometry"/></mxCell></datastore><mxCell id="18" value="D1" style="fillColor=#343a40;fontColor=white;strokeColor=#343a40;rounded=1;editable=0;movable=0;resizable=0;cloneable=0;deletable=0;" vertex="1" connectable="0" parent="17"><mxGeometry width="35" height="60" as="geometry"/></mxCell><datastore label="Goods Sold File" id="19"><mxCell style="fillColor=white;strokeColor=#343a40;fontColor=#343a40;rounded=1;foldable=0;" vertex="1" item_type="datastore" parent="1"><mxGeometry x="56" y="454" width="154" height="60" as="geometry"/></mxCell></datastore><mxCell id="20" value="D2" style="fillColor=#343a40;fontColor=white;strokeColor=#343a40;rounded=1;editable=0;movable=0;resizable=0;cloneable=0;deletable=0;" vertex="1" connectable="0" parent="19"><mxGeometry width="35" height="60" as="geometry"/></mxCell><mxCell id="21" value="Formatted Good Sold Data" style="edgeStyle=topToBottomEdgeStyle;" edge="1" item_type="flow" source="6" target="19" parent="1"><mxGeometry x="-0.1325" y="-20" relative="1" as="geometry"><Array as="points"><mxPoint x="133" y="350"/></Array><mxPoint x="20" y="-20" as="offset"/></mxGeometry></mxCell><mxCell id="22" value="Daily Goods Sold Amounts" style="edgeStyle=topToBottomEdgeStyle;" edge="1" item_type="flow" source="19" target="10" parent="1"><mxGeometry x="0.0027" y="10" relative="1" as="geometry"><Array as="points"><mxPoint x="130" y="570"/></Array><mxPoint as="offset"/></mxGeometry></mxCell><mxCell id="23" value="Formatted Inventory Data" style="edgeStyle=topToBottomEdgeStyle;" edge="1" item_type="flow" source="8" target="17" parent="1"><mxGeometry x="-0.0939" y="20" relative="1" as="geometry"><Array as="points"><mxPoint x="870" y="350"/></Array><mxPoint x="-20" y="-20" as="offset"/></mxGeometry></mxCell><mxCell id="24" value="Daily Inventory Depletion Amounts" style="edgeStyle=topToBottomEdgeStyle;" edge="1" item_type="flow" source="17" target="10" parent="1"><mxGeometry x="0.004" y="-10" relative="1" as="geometry"><Array as="points"><mxPoint x="870" y="540"/></Array><mxPoint as="offset"/></mxGeometry></mxCell><entity label="Restaurant Manager" required_inflows="[&quot;Management Reports&quot;]" required_outflows="[]" from_parent="true" id="25"><mxCell style="fillColor=white;strokeColor=#343a40;fontColor=#343a40;rounded=1;foldable=0;" vertex="1" item_type="entity" parent="1"><mxGeometry x="830" y="594" width="110" height="80" as="geometry"/></mxCell></entity><mxCell id="26" value="Management Reports" style="edgeStyle=topToBottomEdgeStyle;" edge="1" item_type="flow" source="10" target="25" parent="1"><mxGeometry y="14" relative="1" as="geometry"><mxPoint as="offset"/></mxGeometry></mxCell></root></mxGraphModel>'
receive_and_transform_customer_order_xml_model = '<mxGraphModel><root><mxCell id="0"/><mxCell id="1" parent="0"/><entity label="Customer" required_inflows="[&quot;Receipt&quot;]" required_outflows="[&quot;Customer Order&quot;]" from_parent="true" id="2"><mxCell style="fillColor=white;strokeColor=#343a40;fontColor=#343a40;rounded=1;foldable=0;" vertex="1" item_type="entity" parent="1"><mxGeometry x="144.66668701171875" y="34.833343505859375" width="100" height="80" as="geometry"/></mxCell></entity><process label="Update Goods Sold File" from_parent="true" required_inflows="[&quot;Goods Sold&quot;]" required_outflows="[]" id="3"><mxCell style="fillColor=white;strokeColor=#343a40;fontColor=#343a40;rounded=1;foldable=0;" vertex="1" item_type="process" parent="1"><mxGeometry x="134.66668701171875" y="540.1666870117188" width="120" height="120" as="geometry"/></mxCell></process><mxCell id="4" value="2" style="fillColor=#343a40;fontColor=white;strokeColor=#343a40;rounded=1;editable=0;movable=0;resizable=0;cloneable=0;deletable=0;" vertex="1" connectable="0" parent="3"><mxGeometry width="120" height="24" as="geometry"/></mxCell><entity label="Kitchen" required_inflows="[&quot;Food Order&quot;]" required_outflows="[]" from_parent="true" id="5"><mxCell style="fillColor=white;strokeColor=#343a40;fontColor=#343a40;rounded=1;foldable=0;" vertex="1" item_type="entity" parent="1"><mxGeometry x="799.8333740234375" y="34.66668701171875" width="100" height="80" as="geometry"/></mxCell></entity><process label="Update Inventory File" from_parent="true" required_inflows="[&quot;Inventory Data&quot;]" required_outflows="[]" id="6"><mxCell style="fillColor=white;strokeColor=#343a40;fontColor=#343a40;rounded=1;foldable=0;" vertex="1" item_type="process" parent="1"><mxGeometry x="800" y="540.1666870117188" width="120" height="120" as="geometry"/></mxCell></process><mxCell id="7" value="3" style="fillColor=#343a40;fontColor=white;strokeColor=#343a40;rounded=1;editable=0;movable=0;resizable=0;cloneable=0;deletable=0;" vertex="1" connectable="0" parent="6"><mxGeometry width="120" height="24" as="geometry"/></mxCell><process label="Receive Customer Order" id="8"><mxCell style="fillColor=white;strokeColor=#343a40;fontColor=#343a40;rounded=1;foldable=0;" vertex="1" item_type="process" parent="1"><mxGeometry x="280" y="134" width="140" height="120" as="geometry"/></mxCell></process><mxCell id="9" value="1.1" style="fillColor=#343a40;fontColor=white;strokeColor=#343a40;rounded=1;editable=0;movable=0;resizable=0;cloneable=0;deletable=0;" vertex="1" connectable="0" parent="8"><mxGeometry width="140" height="24" as="geometry"/></mxCell><process label="Generate Customer Receipt" id="10"><mxCell style="fillColor=white;strokeColor=#343a40;fontColor=#343a40;rounded=1;foldable=0;" vertex="1" item_type="process" parent="1"><mxGeometry x="280" y="380" width="139" height="120" as="geometry"/></mxCell></process><mxCell id="11" value="1.2" style="fillColor=#343a40;fontColor=white;strokeColor=#343a40;rounded=1;editable=0;movable=0;resizable=0;cloneable=0;deletable=0;" vertex="1" connectable="0" parent="10"><mxGeometry width="139" height="24" as="geometry"/></mxCell><process label="Transform Order to Kitchen Format" id="12"><mxCell style="fillColor=white;strokeColor=#343a40;fontColor=#343a40;rounded=1;foldable=0;" vertex="1" item_type="process" parent="1"><mxGeometry x="560" y="134" width="180" height="120" as="geometry"/></mxCell></process><mxCell id="13" value="1.3" style="fillColor=#343a40;fontColor=white;strokeColor=#343a40;rounded=1;editable=0;movable=0;resizable=0;cloneable=0;deletable=0;" vertex="1" connectable="0" parent="12"><mxGeometry width="180" height="24" as="geometry"/></mxCell><process label="Generate Goods Sold Increments" id="14"><mxCell style="fillColor=white;strokeColor=#343a40;fontColor=#343a40;rounded=1;foldable=0;" vertex="1" item_type="process" parent="1"><mxGeometry x="565" y="380" width="170" height="120" as="geometry"/></mxCell></process><mxCell id="15" value="1.4" style="fillColor=#343a40;fontColor=white;strokeColor=#343a40;rounded=1;editable=0;movable=0;resizable=0;cloneable=0;deletable=0;" vertex="1" connectable="0" parent="14"><mxGeometry width="170" height="24" as="geometry"/></mxCell><process label="Generate Inventory Decrements" id="16"><mxCell style="fillColor=white;strokeColor=#343a40;fontColor=#343a40;rounded=1;foldable=0;" vertex="1" item_type="process" parent="1"><mxGeometry x="780" y="250" width="160" height="120" as="geometry"/></mxCell></process><mxCell id="17" value="1.5" style="fillColor=#343a40;fontColor=white;strokeColor=#343a40;rounded=1;editable=0;movable=0;resizable=0;cloneable=0;deletable=0;" vertex="1" connectable="0" parent="16"><mxGeometry width="160" height="24" as="geometry"/></mxCell><mxCell id="18" value="Customer Order" style="edgeStyle=topToBottomEdgeStyle;" edge="1" item_type="flow" source="2" target="8" parent="1"><mxGeometry x="-0.3054" y="10" relative="1" as="geometry"><Array as="points"><mxPoint x="350" y="80"/></Array><mxPoint as="offset"/></mxGeometry></mxCell><mxCell id="19" value="Receipt" style="edgeStyle=topToBottomEdgeStyle;" edge="1" item_type="flow" source="10" target="2" parent="1"><mxGeometry x="-0.0004" y="25" relative="1" as="geometry"><Array as="points"><mxPoint x="195" y="440"/></Array><mxPoint as="offset"/></mxGeometry></mxCell><mxCell id="20" value="Customer Order" style="edgeStyle=topToBottomEdgeStyle;" edge="1" item_type="flow" source="8" target="10" parent="1"><mxGeometry y="-50" relative="1" as="geometry"><Array as="points"><mxPoint x="350" y="317"/></Array><mxPoint as="offset"/></mxGeometry></mxCell><mxCell id="21" value="Customer Order" style="edgeStyle=topToBottomEdgeStyle;" edge="1" item_type="flow" source="8" target="12" parent="1"><mxGeometry y="14" relative="1" as="geometry"><mxPoint as="offset"/></mxGeometry></mxCell><mxCell id="22" value="Customer Order" style="edgeStyle=topToBottomEdgeStyle;" edge="1" item_type="flow" source="8" target="16" parent="1"><mxGeometry x="-0.0096" y="10" relative="1" as="geometry"><Array as="points"><mxPoint x="400" y="290"/></Array><mxPoint as="offset"/></mxGeometry></mxCell><mxCell id="23" value="Customer Order" style="edgeStyle=topToBottomEdgeStyle;" edge="1" item_type="flow" source="8" target="14" parent="1"><mxGeometry y="-13" relative="1" as="geometry"><Array as="points"><mxPoint x="380" y="317"/></Array><mxPoint as="offset"/></mxGeometry></mxCell><mxCell id="24" value="Food Order" style="edgeStyle=topToBottomEdgeStyle;" edge="1" item_type="flow" source="12" target="5" parent="1"><mxGeometry x="-0.3156" y="10" relative="1" as="geometry"><Array as="points"><mxPoint x="850" y="180"/></Array><mxPoint as="offset"/></mxGeometry></mxCell><mxCell id="25" value="Inventory Data" style="edgeStyle=topToBottomEdgeStyle;" edge="1" item_type="flow" source="16" target="6" parent="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="26" value="Goods Sold" style="edgeStyle=topToBottomEdgeStyle;" edge="1" item_type="flow" source="14" target="3" parent="1"><mxGeometry x="0.0091" y="-10" relative="1" as="geometry"><Array as="points"><mxPoint x="440" y="600"/></Array><mxPoint as="offset"/></mxGeometry></mxCell></root></mxGraphModel>'
produce_management_reports_xml_model = '<mxGraphModel><root><mxCell id="0"/><mxCell id="1" parent="0"/><datastore label="Goods Sold File" from_parent="true" required_inflows="[]" required_outflows="[&quot;Daily Goods Sold Amounts&quot;]" id="2"><mxCell style="fillColor=white;strokeColor=#343a40;fontColor=#343a40;rounded=1;foldable=0;" vertex="1" item_type="datastore" parent="1"><mxGeometry x="50" y="290" width="154" height="60" as="geometry"/></mxCell></datastore><mxCell id="3" value="D2" style="fillColor=#343a40;fontColor=white;strokeColor=#343a40;rounded=1;editable=0;movable=0;resizable=0;cloneable=0;deletable=0;" vertex="1" connectable="0" parent="2"><mxGeometry width="35" height="60" as="geometry"/></mxCell><datastore label="Inventory File" from_parent="true" required_inflows="[]" required_outflows="[&quot;Daily Inventory Depletion Amounts&quot;]" id="4"><mxCell style="fillColor=white;strokeColor=#343a40;fontColor=#343a40;rounded=1;foldable=0;" vertex="1" item_type="datastore" parent="1"><mxGeometry x="365" y="39.8333740234375" width="140" height="60" as="geometry"/></mxCell></datastore><mxCell id="5" value="D1" style="fillColor=#343a40;fontColor=white;strokeColor=#343a40;rounded=1;editable=0;movable=0;resizable=0;cloneable=0;deletable=0;" vertex="1" connectable="0" parent="4"><mxGeometry width="35" height="60" as="geometry"/></mxCell><process label="Access Goods Sold and Inventory Data" id="6"><mxCell style="fillColor=white;strokeColor=#343a40;fontColor=#343a40;rounded=1;foldable=0;" vertex="1" item_type="process" parent="1"><mxGeometry x="330" y="260" width="210" height="120" as="geometry"/></mxCell></process><mxCell id="7" value="4.1" style="fillColor=#343a40;fontColor=white;strokeColor=#343a40;rounded=1;editable=0;movable=0;resizable=0;cloneable=0;deletable=0;" vertex="1" connectable="0" parent="6"><mxGeometry width="210" height="24" as="geometry"/></mxCell><process label="Aggregate Goods Sold and Inventory Data" id="8"><mxCell style="fillColor=white;strokeColor=#343a40;fontColor=#343a40;rounded=1;foldable=0;" vertex="1" item_type="process" parent="1"><mxGeometry x="700" y="260" width="230" height="120" as="geometry"/></mxCell></process><mxCell id="9" value="4.2" style="fillColor=#343a40;fontColor=white;strokeColor=#343a40;rounded=1;editable=0;movable=0;resizable=0;cloneable=0;deletable=0;" vertex="1" connectable="0" parent="8"><mxGeometry width="230" height="24" as="geometry"/></mxCell><process label="Prepare Management Reports" id="10"><mxCell style="fillColor=white;strokeColor=#343a40;fontColor=#343a40;rounded=1;foldable=0;" vertex="1" item_type="process" parent="1"><mxGeometry x="740" y="433" width="150" height="120" as="geometry"/></mxCell></process><mxCell id="11" value="4.3" style="fillColor=#343a40;fontColor=white;strokeColor=#343a40;rounded=1;editable=0;movable=0;resizable=0;cloneable=0;deletable=0;" vertex="1" connectable="0" parent="10"><mxGeometry width="150" height="24" as="geometry"/></mxCell><mxCell id="12" value="Daily Goods Sold Amounts" style="edgeStyle=topToBottomEdgeStyle;" edge="1" item_type="flow" source="2" target="6" parent="1"><mxGeometry y="10" relative="1" as="geometry"><mxPoint as="offset"/></mxGeometry></mxCell><mxCell id="13" value="Daily Inventory Depletion Amounts" style="edgeStyle=topToBottomEdgeStyle;" edge="1" item_type="flow" source="4" target="6" parent="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="14" value="Inventory Data" style="edgeStyle=topToBottomEdgeStyle;" edge="1" item_type="flow" source="6" target="8" parent="1"><mxGeometry y="10" relative="1" as="geometry"><Array as="points"><mxPoint x="620" y="300"/></Array><mxPoint as="offset"/></mxGeometry></mxCell><mxCell id="15" value="Goods Sold Data" style="edgeStyle=topToBottomEdgeStyle;" edge="1" item_type="flow" source="6" target="8" parent="1"><mxGeometry x="0.125" y="14" relative="1" as="geometry"><Array as="points"><mxPoint x="630" y="340"/></Array><mxPoint x="-10" y="4" as="offset"/></mxGeometry></mxCell><mxCell id="16" value="Aggregate Data" style="edgeStyle=topToBottomEdgeStyle;" edge="1" item_type="flow" source="8" target="10" parent="1"><mxGeometry relative="1" as="geometry"/></mxCell><entity label="Restaurant Manager" required_inflows="[&quot;Management Reports&quot;]" required_outflows="[]" from_parent="true" id="17"><mxCell style="fillColor=white;strokeColor=#343a40;fontColor=#343a40;rounded=1;foldable=0;" vertex="1" item_type="entity" parent="1"><mxGeometry x="760" y="610" width="110" height="80" as="geometry"/></mxCell></entity><mxCell id="18" value="Management Reports" style="edgeStyle=topToBottomEdgeStyle;" edge="1" item_type="flow" source="10" target="17" parent="1"><mxGeometry relative="1" as="geometry"/></mxCell></root></mxGraphModel>'
prepare_management_reports_xml_model = '<mxGraphModel><root><mxCell id="0"/><mxCell id="1" parent="0"/><process label="Aggregate Goods Sold and Inventory Data" from_parent="true" required_inflows="[]" required_outflows="[&quot;Aggregate Data&quot;]" id="2"><mxCell style="fillColor=white;strokeColor=#343a40;fontColor=#343a40;rounded=1;foldable=0;" vertex="1" item_type="process" parent="1"><mxGeometry x="20" y="250" width="230" height="120" as="geometry"/></mxCell></process><mxCell id="3" value="4.2" style="fillColor=#343a40;fontColor=white;strokeColor=#343a40;rounded=1;editable=0;movable=0;resizable=0;cloneable=0;deletable=0;" vertex="1" connectable="0" parent="2"><mxGeometry width="230" height="24" as="geometry"/></mxCell><entity label="Restaurant Manager" required_inflows="[&quot;Management Reports&quot;]" required_outflows="[]" from_parent="true" id="4"><mxCell style="fillColor=white;strokeColor=#343a40;fontColor=#343a40;rounded=1;foldable=0;" vertex="1" item_type="entity" parent="1"><mxGeometry x="758.5" y="590" width="110" height="80" as="geometry"/></mxCell></entity><process label="Format Management Reports" id="5"><mxCell style="fillColor=white;strokeColor=#343a40;fontColor=#343a40;rounded=1;foldable=0;" vertex="1" item_type="process" parent="1"><mxGeometry x="400" y="250" width="150" height="120" as="geometry"/></mxCell></process><mxCell id="6" value="4.3.1" style="fillColor=#343a40;fontColor=white;strokeColor=#343a40;rounded=1;editable=0;movable=0;resizable=0;cloneable=0;deletable=0;" vertex="1" connectable="0" parent="5"><mxGeometry width="150" height="24" as="geometry"/></mxCell><process label="Print Management Reports" id="7"><mxCell style="fillColor=white;strokeColor=#343a40;fontColor=#343a40;rounded=1;foldable=0;" vertex="1" item_type="process" parent="1"><mxGeometry x="740" y="250" width="147" height="120" as="geometry"/></mxCell></process><mxCell id="8" value="4.3.2" style="fillColor=#343a40;fontColor=white;strokeColor=#343a40;rounded=1;editable=0;movable=0;resizable=0;cloneable=0;deletable=0;" vertex="1" connectable="0" parent="7"><mxGeometry width="147" height="24" as="geometry"/></mxCell><mxCell id="9" value="Aggregate Data" style="edgeStyle=topToBottomEdgeStyle;" edge="1" item_type="flow" source="2" target="5" parent="1"><mxGeometry y="10" relative="1" as="geometry"><mxPoint as="offset"/></mxGeometry></mxCell><mxCell id="10" value="Formatted Data" style="edgeStyle=topToBottomEdgeStyle;" edge="1" item_type="flow" source="5" target="7" parent="1"><mxGeometry y="10" relative="1" as="geometry"><mxPoint as="offset"/></mxGeometry></mxCell><mxCell id="11" value="Management Reports" style="edgeStyle=topToBottomEdgeStyle;" edge="1" item_type="flow" source="7" target="4" parent="1"><mxGeometry relative="1" as="geometry"/></mxCell></root></mxGraphModel>'
root_graph_xml_model = '<mxGraphModel><root><mxCell id="0"/><mxCell id="1" parent="0"/><mxCell id="2" value="Process" style="shape=ellipse" vertex="1" parent="1"><mxGeometry x="374.66668701171875" y="214.66668701171875" width="120" height="120" as="geometry"/></mxCell></root></mxGraphModel>'

context_diagram = Graph(title='Context diagram', level=0,
                        xml_model=context_diagram_xml_model)
food_ordering_system = Graph(title='Food Ordering System', level=2,
                             xml_model=food_ordering_system_xml_model)
receive_and_transform_customer_order = Graph(
    title='Receive and Transform Customer Order', level=2, xml_model=receive_and_transform_customer_order_xml_model)
produce_management_reports = Graph(
    title='Produce Management Reports', level=2, xml_model=produce_management_reports_xml_model)
prepare_management_reports = Graph(
    title='Prepare Management Reports', level=3, xml_model=prepare_management_reports_xml_model)
root_graph = Graph(title='Context diagram', level=0,
                   xml_model=root_graph_xml_model)

db.session.add(context_diagram)
db.session.add(food_ordering_system)
db.session.add(receive_and_transform_customer_order)
db.session.add(produce_management_reports)
db.session.add(prepare_management_reports)
db.session.add(root_graph)
db.session.commit()

# Connect graphs
child1 = GraphChildren(parent=context_diagram.id,
                       child=food_ordering_system.id)
child2 = GraphChildren(parent=food_ordering_system.id,
                       child=receive_and_transform_customer_order.id)
child3 = GraphChildren(parent=food_ordering_system.id,
                       child=produce_management_reports.id)
child4 = GraphChildren(parent=produce_management_reports.id,
                       child=prepare_management_reports.id)

db.session.add(child1)
db.session.add(child2)
db.session.add(child3)
db.session.add(child4)
db.session.commit()

# Create demo DFD
dfd1 = DataFlowDiagram(
    title='Food Ordering System', graph=context_diagram.id, author=user_1.id)
dfd2 = DataFlowDiagram(
    title='Demo DFD', graph=root_graph.id, author=user_1.id)

db.session.add(dfd1)
db.session.add(dfd2)
db.session.commit()

# Invite a user
invite = Invitation(invited_user=user_2.id, invited_to=dfd1.id)

db.session.add(invite)
db.session.commit()

# Edit diagram
Graph.query.get(dfd2.graph).xml_model = root_graph_xml_model.replace(
    'Process', 'Edit')
edit = Edit(editor=user_2.id, edited_diagram=dfd2.id,
            message='Edited context diagram')

db.session.add(edit)
db.session.commit()

Graph.query.get(dfd2.graph).xml_model = root_graph_xml_model.replace(
    'Process', 'Edit 2')
edit = Edit(editor=user_2.id, edited_diagram=dfd2.id,
            message='Edited context diagram again')

db.session.add(edit)
db.session.commit()
